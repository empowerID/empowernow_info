<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>IdP — Agent Passports & Consent</title>
  <meta name="description" content="Issue ARIA Passports with pairwise identities, schema pins, plan contracts, and optional consent. Standards: RAR, PAR, JARM, FAPI 2.0, OIDC." />
  <link rel="stylesheet" href="../css/fabric.css" />
  <script type="application/ld+json">
  {"@context":"https://schema.org","@type":"Product","name":"EmpowerNow IdP","brand":{"@type":"Brand","name":"EmpowerNow"},"description":"OAuth/OIDC IdP for agent passports and consent with RAR, PAR, JARM, and FAPI 2.0 support.","url":"https://empowerid.github.io/empowernow_info/docs/product/idp.html"}
  </script>
</head>
<body>
  <nav style="padding:16px 0;border-bottom:1px solid rgba(0,231,246,.3)">
    <div class="container" style="display:flex;justify-content:space-between;align-items:center">
      <a href="../index.html" style="color:#00E7F6;text-decoration:none;font-weight:700">EmpowerNow</a>
      <div style="display:flex;gap:24px">
        <a href="../product/index.html">Product</a>
        <a href="../solutions/index.html">Solutions</a>
        <a href="../docs/index.html">Docs</a>
        <a href="../resources/index.html">Resources</a>
        <a href="../pricing/index.html">Pricing</a>
        <a href="../trust/index.html">Trust</a>
        <a href="../about/index.html">Company</a>
        <a href="../demo/index.html" class="btn btn-primary">Book a Demo</a>
      </div>
    </div>
  </nav>

  <header class="container" style="padding:72px 0 32px">
    <div class="hero-grid">
      <div class="hero-copy">
        <h1 class="display">EmpowerNow IdP</h1>
        <p class="lead">Issue ARIA Passports that bind agents to users, pin tool schemas, and carry plan/budget context. Add consent where policy requires.</p>
        <div style="display:flex;gap:12px;flex-wrap:wrap">
          <a class="btn btn-primary" href="../resources/index.html#demo">Watch demo</a>
          <a class="btn" href="https://empowerid.github.io/empowernow_docs/docs/website_copy/standards/">See Standards</a>
        </div>
      </div>
      <div class="hero-art" aria-hidden="true">
        <div class="glass-card" style="padding:24px">
          <h3 style="margin:0 0 8px">Passports at a glance</h3>
          <ul class="bullets-small">
            <li>Pairwise identities for user↔agent binding</li>
            <li>authorization_details (RAR) for structured permissions</li>
            <li>Schema pins per tool (version/hash)</li>
            <li>Optional plan contract JWS and budget envelope</li>
            <li>Consent obligations for high‑risk actions</li>
          </ul>
        </div>
      </div>
    </div>
  </header>

  <section class="container" style="padding-bottom:16px">
    <h2>Overview</h2>
    <ul>
      <li>Pairwise identities (<code>sub</code>) and actor chain (<code>act.sub</code>)</li>
      <li>Plan contracts (JWS) and tool schema pins from the Tool Registry</li>
      <li>Optional DPoP binding (<code>cnf.jkt</code>)</li>
      <li>Policy‑gated identity chaining endpoints</li>
      <li>Discovery + JWKS and ARIA claims documentation endpoints</li>
    </ul>
    <p><strong>Why it matters</strong>: Move agent governance left into identity. Agents receive verifiable, purpose‑built credentials that encode plan discipline, schema integrity, budgets/max_steps, and proof‑of‑possession when enabled.</p>
  </section>

  <section class="container" style="padding-bottom:16px">
    <h2>Identity Chaining (feature‑flagged)</h2>
    <p>Both flows are gated by PDP constraints (<code>constraints.identity_chain</code>).</p>
    <h3>Delegated assertion</h3>
    <pre><code>POST /api/oidc/oauth/identity-assertion
Inputs: subject_token, (optional) actor_token, audience, optional scope
Output: { assertion, token_type, expires_in } (≤ configured TTL, max ~300s)</code></pre>
    <h3>Brokered exchange</h3>
    <pre><code>POST /api/oidc/oauth/identity-chain/token
Inputs: subject_token, (optional) actor_token, audience, optional scope, token_endpoint, client_auth
Output: downstream { access_token, expires_in, ... }</code></pre>
    <p>PDP decides allowed audiences/scopes, TTL caps, and whether DPoP/MTLS are required. IdP enforces those constraints before minting.</p>
  </section>

  <section class="container" style="padding-bottom:16px">
    <h2>Plan Contracts and Schema Pins</h2>
    <ul>
      <li>Plan JWS: signed plan with step indices, params fingerprints, and max cost per step</li>
      <li>Schema pins: <code>{schema_version, schema_hash}</code> for each requested tool, pulled from the Tool Registry</li>
    </ul>
  </section>

  <section class="container" style="padding-bottom:16px">
    <h2>Claims Reference (example)</h2>
    <pre><code>{
  "iss": "https://idp.example.com",
  "sub": "pairwise:9a7b1c2d3e4f5a6b",
  "aud": "aria.gateway",
  "exp": 1735689600,
  "iat": 1735686000,
  "jti": "be0bfe61-2c36-4b72-9d8a-34a5f3c2a108",
  "act": { "sub": "agent:svc-123:for:9a7b1c2d3e4f5a6b" },
  "authorization_details": [
    {
      "type": "aria_agent_delegation",
      "tools": ["mcp:flights:search"],
      "schema_pins": {"mcp:flights:search": {"schema_version": "1.2.0", "schema_hash": "sha256:..."}}
    }
  ],
  "aria": {
    "bound_sub": "pairwise:9a7b1c2d3e4f5a6b",
    "tenant": "acme",
    "schema_pins": {"mcp:flights:search": {"schema_version": "1.2.0", "schema_hash": "sha256:..."}},
    "plan_contract_jws": "&lt;JWS or null&gt;",
    "call_id": "79dfe9b6-5d0e-4b6e-ae9a-d68a1f0c0e0f",
    "budget": {"initial": 100.00, "currency": "USD"},
    "max_steps": 20
  },
  "cnf": { "jkt": "base64url(SHA256(JWK_thumbprint))" }
}</code></pre>
  </section>

  <section class="container" style="padding-bottom:16px">
    <h2>Security Model</h2>
    <ul>
      <li>DPoP binding at token endpoint (optional) with replay protection (JTI cache)</li>
      <li>Pairwise subjects mitigate cross‑audience linkability; agent <code>act.sub</code> binds the user→service relationship</li>
      <li>Plan JWS + schema pins ensure step/order and shape integrity</li>
      <li>Fail‑closed defaults on invalid/missing RAR, inactive delegations, or audience mismatch</li>
    </ul>
  </section>

  <section class="container" style="padding-bottom:16px">
    <h2>Discoverability and Docs</h2>
    <ul>
      <li>Discovery advertises supported RAR types, identity chaining endpoints, and DPoP capability</li>
      <li>JWKS at <code>/jwks</code> and <code>/.well-known/jwks.json</code></li>
      <li>ARIA docs endpoints: <code>GET /aria-metadata</code>, <code>GET /aria-claims</code></li>
    </ul>
  </section>

  <section class="container" style="padding-bottom:32px">
    <h2>Interoperability</h2>
    <ul>
      <li>Gateway accepts Passports as Bearer or (optionally) PoP</li>
      <li>PDP governs identity chaining audiences/scopes/TTL; Gateway enforces constraints and obligations</li>
      <li>Tool Registry is authoritative for pins; Receipt Vault signs and chains receipts</li>
    </ul>
  </section>

  <section class="container" style="padding-bottom:48px">
    <div class="grid-2">
      <a class="card-link" href="https://empowerid.github.io/empowernow_docs/docs/website_copy/standards/rar"><div class="card"><h3>RAR Primer</h3><p>Structured permissions beyond scopes.</p></div></a>
      <a class="card-link" href="https://empowerid.github.io/empowernow_docs/docs/website_copy/standards/fapi-2-0"><div class="card"><h3>FAPI 2.0</h3><p>High‑assurance profiles for OAuth/OIDC.</p></div></a>
    </div>
  </section>
    <script src="../js/pages-fix.js"></script></body>
</html>



