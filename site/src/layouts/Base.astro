---
const { title = 'EmpowerNow', description = 'Identity & Authorization Fabric', canonical = '/', ogImage, hreflangs } = Astro.props as any;
import '../styles/tokens.css';
import '../styles/utilities.css';
---
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>{title}</title>
		<meta name="description" content={description} />
        <link rel="canonical" href={new URL(`${import.meta.env.BASE_URL}${String(canonical||'').replace(/^\//,'')}`, Astro.site)} />
		<meta name="theme-color" content="#0B1C3D" />
		<meta property="og:type" content="website" />
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
        <meta property="og:url" content={new URL(`${import.meta.env.BASE_URL}${String(canonical||'').replace(/^\//,'')}`, Astro.site)} />
		{(ogImage
			? <meta property="og:image" content={ogImage} />
			: <meta property="og:image" content={new URL(`${import.meta.env.BASE_URL}images/en-logo-dark.png`, Astro.site)} />)}
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:title" content={title} />
		<meta name="twitter:description" content={description} />
		{(ogImage
			? <meta name="twitter:image" content={ogImage} />
			: <meta name="twitter:image" content={new URL(`${import.meta.env.BASE_URL}images/en-logo-dark.png`, Astro.site)} />)}
		{hreflangs && hreflangs.map((h: { href: string; lang: string }) => <link rel="alternate" hrefLang={h.lang} href={h.href} />)}
		<link rel="icon" href={`${import.meta.env.BASE_URL}favicon.svg`} />
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
		<link rel="preload" as="image" href={`${import.meta.env.BASE_URL}images/en-logo-dark.png`} fetchpriority="high" />
		{String(canonical||'/') === '/' && (
			<link rel="preload" as="image" href={`${import.meta.env.BASE_URL}images/backgrounds/bg-homepage-hero.jpg`} fetchpriority="high" imagesizes="(max-width: 768px) 100vw, 480px" />
		)}
		<style>
			html,body{margin:0;background:var(--navy);color:#fff;font-family:Inter,-apple-system,sans-serif}
			main{min-height:60vh}
			footer{padding:32px 0;margin-top:80px}
			footer a{text-decoration:none}
			footer .btn{text-decoration:none}
			.footer-divider{height:1px;background:linear-gradient(90deg, transparent, rgba(0,231,246,.35), transparent);margin-bottom:60px}
			.footer-icon-tooltip:hover .tooltip-text{visibility:visible !important;opacity:1 !important}
			nav{position:sticky;top:0;z-index:1000}
			.consent{position:fixed;bottom:16px;left:16px;right:16px;z-index:1100}
			.sr-only-focusable{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
			.sticky-cta{position:fixed;left:0;right:0;bottom:0;z-index:1090;transform:translateY(110%);transition:transform .25s ease;backdrop-filter:blur(8px);background:rgba(15,27,51,.72);border-top:1px solid rgba(255,255,255,.12)}
			.sticky-cta.is-visible{transform:translateY(0)}
			/* Global link styles: avoid purple visited, underline only on hover */
			a{color:var(--on-bg);text-decoration:none}
			a:hover{color:var(--color-accent);text-decoration:underline}
			a:visited{color:var(--on-bg)}
			/* Visible focus ring for all focusable controls */
			a:focus-visible, button:focus-visible, .btn:focus-visible, summary:focus-visible, [role="button"]:focus-visible, .chip:focus-visible { outline:2px solid var(--pulse-cyan); outline-offset:2px; border-radius:6px }
			/* Nav underline grow */
			.nav-link{position:relative;color:var(--nav-ink-dim);background-image:linear-gradient(currentColor,currentColor);background-repeat:no-repeat;background-size:0% 2px;background-position:0 100%;transition:background-size .12s ease,color .12s ease; padding:.5rem .75rem;border-radius:999px; background:transparent; border:0; appearance:none; -webkit-appearance:none; font:inherit; cursor:pointer}
			.nav-link:hover,.nav-link:focus{color:var(--nav-ink);background-size:100% 2px}
			/* Mega menu */
            .nav-group{position:relative}
            /* Mega menu panel aligned to nav container */
            .mega{position:fixed;left:50%;transform:translateX(-50%);top:64px; z-index:1010; width:min(1120px, calc(100vw - 32px)); background:#0F1B33; border:1px solid rgba(255,255,255,.06); border-radius:16px; box-shadow:0 12px 50px rgba(0,0,0,.35); isolation:isolate; overflow:hidden}
            .mega::before{content:""; position:absolute; inset:0; background:#0F1B33; pointer-events:none}
            .mega::after{content:""; position:absolute; inset:0; background:linear-gradient(180deg, rgba(12,20,36,.82), rgba(12,20,36,.66)); pointer-events:none}
            .mega-inner{position:relative; z-index:1; display:grid;grid-template-columns:4fr 8fr;gap:18px;padding:16px 0 18px}
            .mega-left{padding:16px 18px}
            .mega-left .h3{color:var(--ink,#E9F0FF);font-weight:800;letter-spacing:-.01em}
            .mega-left .body{color:var(--ink,#E9F0FF);opacity:.9}
            .mega-cta{color:var(--ink,#E9F0FF); text-decoration:underline; display:inline-block; margin-top:10px; font-weight:700; text-underline-offset:3px}
            .mega-grid{display:grid;grid-template-columns:repeat(2, minmax(0,1fr));gap:14px 18px;padding:0 0 2px}
            @media (min-width: 1280px){ .mega-grid{ grid-template-columns:repeat(3, minmax(0,1fr)) } }
            .mega-card{position:relative;display:grid;grid-template-rows:auto auto 1fr auto;row-gap:6px;background:rgba(255,255,255,.04);border-radius:14px;padding:16px 18px;border:1px solid rgba(255,255,255,.06)}
            .mega-card:hover{transform:translateY(-4px);background:rgba(255,255,255,.06);box-shadow:0 10px 22px rgba(0,0,0,.25)}
            .mega-card:hover::before{content:"";position:absolute;left:0;right:0;top:0;height:2px;background:linear-gradient(90deg,var(--quantum-violet,#7C5CFF),var(--pulse-cyan,#4CC9F0));border-top-left-radius:14px;border-top-right-radius:14px}
            .mega-card:focus-within{outline:2px solid var(--ion-lime,#00E1A8); outline-offset:3px}
            .mega-card .h3{font-size:20px;line-height:1.2;margin:0}
            .clamp-2{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
            .links{display:flex;gap:10px;margin-top:10px}
            .links .link{color:#e6eef8}
            .links .link-dim{color:#b3c1da}
			/* Dropdown */
            .dropdown{position:absolute; top:100%; right:0; background:#0F1B33; border:1px solid rgba(255,255,255,.08); border-radius:16px; padding:8px; min-width:320px; box-shadow:0 16px 48px rgba(0,229,255,.15); z-index:1010; isolation:isolate; overflow:hidden}
            .dropdown::before{content:""; position:absolute; inset:0; background:linear-gradient(180deg, rgba(12,20,36,.82), rgba(12,20,36,.66)); pointer-events:none}
            .dropdown > *{position:relative; z-index:1}
            /* Centered variant (used by Resources) */
            .dropdown--center{position:fixed; top:64px; left:50%; transform:translateX(-50%); right:auto}
            .dropdown-item{display:block; padding:10px 12px; border-radius:10px}
			.dropdown-item:hover,.dropdown-item:focus{background:rgba(255,255,255,.06)}
		</style>
	</head>
    <body>
		<a href="#main" class="sr-only-focusable">Skip to content</a>
        <nav aria-label="Primary navigation">
            <div class="container wrap" style="display:flex;justify-content:space-between;align-items:center;padding:12px 0;backdrop-filter:blur(10px);background:var(--nav-bg);border-bottom:1px solid var(--nav-border)">
				<a href={import.meta.env.BASE_URL} style="display:inline-flex;align-items:center;gap:8px;text-decoration:none;margin-bottom:-2px">
					<img src={`${import.meta.env.BASE_URL}images/empowernow-logo.svg`} alt="EmpowerNow" width="140" height="28" decoding="async" fetchpriority="high" style="height:44px;width:auto" />
				</a>
                <button id="nav-open" class="btn" aria-controls="mobile-nav" aria-expanded="false" style="display:none">Menu</button>
                <ul class="nav-links">
                    <li>
                        <div class="nav-group">
                            <button class="nav-link" id="btn-products" aria-haspopup="true" aria-expanded="false" aria-controls="menu-products" data-ev="nav_click" data-label="Products">Products</button>
                            <div id="menu-products" role="menu" aria-labelledby="btn-products" hidden class="mega" data-menu style="pointer-events:auto">
                                <div class="mega-inner container">
                                    <div class="mega-left">
                                        <div class="h3" style="margin:0 0 6px">Explore products</div>
                                        <div class="body">Create once → enforce everywhere → prove every action.</div>
                                        <a id="cta-products-hub" href={`${import.meta.env.BASE_URL}products/`} class="mega-cta">View all products →</a>
                                    </div>
                                    <div class="mega-grid">
                                        <div class="mega-card" role="menuitem" tabindex="-1">
                                            <div class="h3">IdP</div>
                                            <div class="body clamp-2">OAuth 2.1 + Token Exchange (RFC 8693); agent passports; pairwise subjects.</div>
                                            <div class="links"><a class="link" href={`${import.meta.env.BASE_URL}products/idp/`}>Learn more →</a></div>
                                        </div>
                                        <div class="mega-card" role="menuitem" tabindex="-1">
                                            <div class="h3">PDP</div>
                                            <div class="body clamp-2">OpenID AuthZEN PDP; standardized decisions with constraints/obligations/TTL.</div>
                                            <div class="links"><a class="link" href={`${import.meta.env.BASE_URL}products/pdp/`}>Learn more →</a></div>
                                        </div>
                                        <div class="mega-card" role="menuitem" tabindex="-1">
                                            <div class="h3">CRUD Service</div>
                                            <div class="body clamp-2">No‑code connectors/workflows; MCP‑ready tools for MCP/Functions/Copilot; approvals & idempotency.</div>
                                            <div class="links"><a class="link" href={`${import.meta.env.BASE_URL}products/crud/`}>Learn more →</a></div>
                                        </div>
                                        <div class="mega-card" role="menuitem" tabindex="-1">
                                            <div class="h3">Data Collector</div>
                                            <div class="body clamp-2">Identity/IGA inventory & lineage (accounts, entitlements, memberships, sources) feeding PDP/PIP.</div>
                                            <div class="links"><a class="link" href={`${import.meta.env.BASE_URL}products/data-collector/`}>Learn more →</a></div>
                                        </div>
                                        <div class="mega-card" role="menuitem" tabindex="-1">
                                            <div class="h3">ARIA Shield</div>
                                            <div class="body clamp-2">Runtime budgets (HTTP 402), streaming caps, zero‑token SPA; pre‑exec enforcement.</div>
                                            <div class="links"><a class="link" href={`${import.meta.env.BASE_URL}products/aria-shield/`}>Learn more →</a></div>
                                        </div>
                                        <div class="mega-card" role="menuitem" tabindex="-1">
                                            <div class="h3">ARIA MCP Gateway</div>
                                            <div class="body clamp-2">Plan discipline & schema pins; deny off‑plan tool calls before execution.</div>
                                            <div class="links"><a class="link" href={`${import.meta.env.BASE_URL}products/gateway/`}>Learn more →</a></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="nav-group">
                            <button class="nav-link" id="btn-solutions" aria-haspopup="true" aria-expanded="false" aria-controls="menu-solutions" data-ev="nav_click" data-label="Solutions">Solutions</button>
                            <div id="menu-solutions" role="menu" aria-labelledby="btn-solutions" hidden class="mega" data-menu style="pointer-events:auto">
                                <div class="mega-inner container">
                                    <div class="mega-left">
                                        <div class="h3" style="margin:0 0 6px">Explore solutions</div>
                                        <div class="body">OEM/white‑label for platforms, bundles for SIs, starter kits for enterprises.</div>
                                        <a id="cta-solutions-hub" href={`${import.meta.env.BASE_URL}solutions/`} class="mega-cta">View all solutions →</a>
                                    </div>
                                    <div class="mega-grid">
                                        <div class="mega-card" role="menuitem" tabindex="-1">
                                            <div class="h3">Agent Platforms (OEM/white‑label)</div>
                                            <div class="body clamp-2">Embed IdP/PDP/CRUD, ARIA Shield & MCP Gateway under your brand.</div>
                                            <div class="links"><a class="link" href={`${import.meta.env.BASE_URL}solutions/agent-safe-tools/`}>Partner →</a><a class="link-dim" href={`${import.meta.env.BASE_URL}resources/`}>Guide ↗</a></div>
                                        </div>
                                        <div class="mega-card" role="menuitem" tabindex="-1">
                                            <div class="h3">Systems Integrators (SI/GSI)</div>
                                            <div class="body clamp-2">Vertical catalog kits + policy packs + delivery playbooks.</div>
                                            <div class="links"><a class="link" href={`${import.meta.env.BASE_URL}solutions/delegated-authorization/`}>Partner →</a><a class="link-dim" href={`${import.meta.env.BASE_URL}resources/`}>Kit examples ↗</a></div>
                                        </div>
                                        <div class="mega-card" role="menuitem" tabindex="-1">
                                            <div class="h3">Enterprises (Governed Starter)</div>
                                            <div class="body clamp-2">20–50 endpoints; budgets 402; content/egress controls; receipts.</div>
                                            <div class="links"><a class="link" href={`${import.meta.env.BASE_URL}solutions/spend-governance/`}>Get started →</a><a class="link-dim" href={`${import.meta.env.BASE_URL}docs/`}>Quickstart ↗</a></div>
                                        </div>
                                        <div class="mega-card" role="menuitem" tabindex="-1">
                                            <div class="h3">Zero‑Token SPAs</div>
                                            <div class="body clamp-2">BFF/Shield pattern; tokens stay in the backend; route‑level policy.</div>
                                            <div class="links"><a class="link" href={`${import.meta.env.BASE_URL}solutions/zero-token-spas/`}>Learn more →</a><a class="link-dim" href={`${import.meta.env.BASE_URL}docs/`}>Docs ↗</a></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="nav-group">
                            <button class="nav-link" id="btn-resources" aria-haspopup="true" aria-expanded="false" aria-controls="menu-resources" data-ev="nav_click" data-label="Resources">Resources</button>
                            <div id="menu-resources" role="menu" aria-labelledby="btn-resources" hidden class="dropdown dropdown--center" data-menu>
                                <a role="menuitem" tabindex="-1" href={`${import.meta.env.BASE_URL}resources/`} class="dropdown-item">Overview</a>
                                <a role="menuitem" tabindex="-1" href={`${import.meta.env.BASE_URL}docs/crud-service/quickstart`} class="dropdown-item">Quickstart</a>
                                <a role="menuitem" tabindex="-1" href={`${import.meta.env.BASE_URL}products/crud/`} class="dropdown-item">Adapter catalog</a>
                                <a role="menuitem" tabindex="-1" href={`${import.meta.env.BASE_URL}resources/`} class="dropdown-item">Workflow examples</a>
                                <a role="menuitem" tabindex="-1" href={`${import.meta.env.BASE_URL}resources/standards/`} class="dropdown-item">Standards</a>
                            </div>
                        </div>
                    </li>
					<li><a href="https://empowerid.github.io/empowernow_docs/" target="_blank" rel="noopener">Docs</a></li>
                    <li><a class="nav-link" href={`${import.meta.env.BASE_URL}pricing/`} data-ev="nav_click" data-label="Pricing">Pricing</a></li>
                    <li>
                        <div class="nav-group">
                            <button class="nav-link" id="btn-company" aria-haspopup="true" aria-expanded="false" aria-controls="menu-company" data-ev="nav_click" data-label="Company">Company</button>
                            <div id="menu-company" role="menu" aria-labelledby="btn-company" hidden class="dropdown" data-menu>
                                <a role="menuitem" tabindex="-1" href={`${import.meta.env.BASE_URL}company/`} class="dropdown-item">About</a>
                                <a role="menuitem" tabindex="-1" href={`${import.meta.env.BASE_URL}company/built-by-empowerid/`} class="dropdown-item">Built by EmpowerID</a>
                                <a role="menuitem" tabindex="-1" href={`${import.meta.env.BASE_URL}company/`} class="dropdown-item">Press & News</a>
                            </div>
                        </div>
                    </li>
                    <li><a class="btn btn-primary" href={`${import.meta.env.BASE_URL}demo/`} data-ev="cta_click" data-label="nav_demo" data-cta-level="hard" data-product="na" data-persona="na" data-stage="na">Book Demo</a></li>
				</ul>
            </div>
            <div id="mobile-nav" hidden style="position:fixed;left:0;right:0;top:0;height:92vh;transform:translateY(-100%);transition:transform .18s ease; background:rgba(12,20,36,.95);backdrop-filter:blur(10px);border-bottom:1px solid rgba(255,255,255,.08);z-index:1050">
                <div class="container" style="padding:16px">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
                        <strong>Menu</strong>
                        <button id="nav-close" class="btn">Close</button>
                    </div>
                    <div style="display:grid;gap:8px">
                        <a class="btn" href={`${import.meta.env.BASE_URL}products/`}>Products</a>
                        <a class="btn" href={`${import.meta.env.BASE_URL}solutions/`}>Solutions</a>
                        <a class="btn" href={`${import.meta.env.BASE_URL}resources/`}>Resources</a>
                        <a class="btn" href="https://empowerid.github.io/empowernow_docs/">Docs</a>
                        <a class="btn" href={`${import.meta.env.BASE_URL}pricing/`}>Pricing</a>
                        <a class="btn" href={`${import.meta.env.BASE_URL}company/`}>Company</a>
                        <div style="display:flex;gap:8px;margin-top:8px">
                            <a class="btn btn-primary" href={`${import.meta.env.BASE_URL}demo/`}>Book Demo</a>
                            <a class="btn" href={`${import.meta.env.BASE_URL}docs/crud-service/quickstart`}>Quickstart</a>
                        </div>
                    </div>
                </div>
            </div>
		</nav>
        <div id="sticky-cta" class="sticky-cta" hidden>
            <div class="container" style="display:flex;gap:10px;justify-content:space-between;align-items:center;padding:10px">
                <div style="color:#9ba3b7;font-size:.95rem">Ship confidently — book a 15‑min demo.</div>
                <div style="display:flex;gap:8px">
                    <a class="btn btn-primary" data-ev="cta_click" data-label="book_demo_sticky" href={`${import.meta.env.BASE_URL}demo/`}>Book 15‑min demo</a>
                    <a class="btn" data-ev="cta_click" data-label="watch_demo_sticky" href={`${import.meta.env.BASE_URL}resources/demo/`}>Watch demo</a>
                </div>
            </div>
        </div>
        <main id="main">
			<slot />
		</main>
        <div class="footer-divider"></div>
        <footer class="site-footer" style={`background-image:url(${import.meta.env.BASE_URL}images/backgrounds/bg-footer.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;padding:60px 0 120px`}>
            <div class="container footer-top">
                <div class="footer-brand">
                    <div style="display:inline-flex;align-items:center;gap:8px;text-decoration:none;margin-bottom:-2px">
                        <img src={`${import.meta.env.BASE_URL}images/empowernow-logo.svg`} alt="EmpowerNow" style="height:44px;width:auto;image-rendering:auto" loading="lazy" decoding="async" />
                    </div>
                    <div style="color:#9ba3b7;max-width:340px">Identity & Authorization Fabric for people, services, and AI agents.</div>
                    <div class="footer-trust" style="display:flex;gap:20px;margin-top:20px">
                        <div class="footer-icon-tooltip" style="position:relative;display:inline-block">
                            <img src={`${import.meta.env.BASE_URL}images/icons/icon-aa.png`} alt="AA compliant" style="width:32px;height:32px;cursor:help;transition:transform 0.2s ease" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'" />
                            <span class="tooltip-text" style="visibility:hidden;background-color:rgba(0,0,0,.9);color:#00E7F6;text-align:center;border-radius:6px;padding:6px 12px;position:absolute;z-index:1;bottom:125%;left:50%;margin-left:-50px;opacity:0;transition:opacity 0.2s;font-size:13px;white-space:nowrap;border:1px solid rgba(0,231,246,0.3)">AA compliant</span>
                        </div>
                        <div class="footer-icon-tooltip" style="position:relative;display:inline-block">
                            <img src={`${import.meta.env.BASE_URL}images/icons/icon-receipts-sm.png`} alt="Receipts" style="width:32px;height:32px;cursor:help;transition:transform 0.2s ease" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'" />
                            <span class="tooltip-text" style="visibility:hidden;background-color:rgba(0,0,0,.9);color:#00E7F6;text-align:center;border-radius:6px;padding:6px 12px;position:absolute;z-index:1;bottom:125%;left:50%;margin-left:-35px;opacity:0;transition:opacity 0.2s;font-size:13px;white-space:nowrap;border:1px solid rgba(0,231,246,0.3)">Receipts</span>
                        </div>
                    </div>
                </div>
                <div class="footer-col"><h4>Product</h4><ul>
                    <li><a href={`${import.meta.env.BASE_URL}products/idp/`}>IdP</a></li>
                    <li><a href={`${import.meta.env.BASE_URL}products/pdp/`}>PDP</a></li>
                    <li><a href={`${import.meta.env.BASE_URL}products/gateway/`}>ARIA MCP Gateway</a></li>
                    <li><a href={`${import.meta.env.BASE_URL}products/aria-shield/`}>ARIA Shield</a></li>
                    <li><a href={`${import.meta.env.BASE_URL}products/crud/`}>CRUD Service</a></li>
                    <li><a href={`${import.meta.env.BASE_URL}products/data-collector/`}>Data Collector</a></li>
                    <li><span style="color:#9ba3b7">VDS (Coming soon)</span></li>
                </ul></div>
                <div class="footer-col"><h4>Solutions</h4><ul>
                    <li><a href={`${import.meta.env.BASE_URL}solutions/zero-token-spas/`}>Zero‑token SPAs</a></li>
                    <li><a href={`${import.meta.env.BASE_URL}solutions/agent-safe-tools/`}>Agent‑safe tools</a></li>
                    <li><a href={`${import.meta.env.BASE_URL}solutions/delegated-authorization/`}>Delegated auth</a></li>
                </ul></div>
                <div class="footer-col"><h4>Resources</h4><ul>
                    <li><a href={`${import.meta.env.BASE_URL}resources/`}>Overview</a></li>
                    <li><a href={`${import.meta.env.BASE_URL}resources/standards/`}>Standards</a></li>
                    <li><a href="https://empowerid.github.io/empowernow_docs/" target="_blank" rel="noopener">Docs ↗</a></li>
                </ul></div>
                <div class="footer-col"><h4>Company</h4><ul>
                    <li><a href={`${import.meta.env.BASE_URL}company/`}>About</a></li>
                    <li><a href={`${import.meta.env.BASE_URL}contact/`}>Contact</a></li>
                    <li><a href="https://github.com/empowerID/empowernow_info/blob/main/site/AUTHORING.md" target="_blank" rel="noopener">Authoring guide ↗</a></li>
                </ul></div>
            </div>
            <div class="container footer-bottom" style="margin-top:48px">
                <div>© {new Date().getFullYear()} EmpowerNow</div>
                <div style="display:flex;gap:16px;margin-top:24px">
                    <a class="btn" style="border-color:var(--color-accent);color:var(--color-accent);padding:12px 28px" href={`${import.meta.env.BASE_URL}demo/`}>Book demo</a>
                    <a class="btn" style="padding:12px 28px" href={`${import.meta.env.BASE_URL}resources/standards/`}>Explore standards</a>
                </div>
            </div>
            <div class="container" style="text-align:center;margin-top:48px">
                <button id="back-to-top" class="btn btn-ghost" style="border:2px solid rgba(255,255,255,.2);color:#e8ecff;padding:12px 28px;font-size:15px;transition:all 0.3s ease;opacity:0.8" onmouseover="this.style.opacity='1';this.style.transform='translateY(-2px)'" onmouseout="this.style.opacity='0.8';this.style.transform='translateY(0)'">
                    <span style="display:inline-block;transition:transform 0.3s ease">↑</span> Back to top
                </button>
            </div>
        </footer>
        <script>
            (function(){
                const btn = document.getElementById('back-to-top');
                if(btn){
                    const arrow = btn.querySelector('span');
                    btn.addEventListener('click', () => {
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                        if(arrow){
                            arrow.style.transform = 'translateY(-4px)';
                            setTimeout(() => arrow.style.transform = 'translateY(0)', 300);
                        }
                    });
                }
            })();
        </script>
		<div id="consent" class="consent" hidden>
			<div class="glass-card" style="padding:12px;display:flex;justify-content:space-between;align-items:center;gap:12px">
				<div style="color:#9ba3b7">We use analytics to improve your experience.</div>
				<div style="display:flex;gap:8px">
					<button id="consent-accept" class="btn btn-primary">Allow</button>
					<button id="consent-decline" class="btn">Decline</button>
				</div>
			</div>
		</div>
		<script>
			(function(){
				try{
                    const consentKey = 'analytics_consent';
                    const dnt = (navigator as any).doNotTrack==='1' || (window as any).doNotTrack==='1';
					const consentEl = document.getElementById('consent');
					const acceptBtn = document.getElementById('consent-accept');
					const declineBtn = document.getElementById('consent-decline');
					const has = localStorage.getItem(consentKey);
                    if(!has && consentEl && !dnt){ consentEl.hidden = false; }
					function setConsent(val){ localStorage.setItem(consentKey, val); if(consentEl) consentEl.hidden = true; }
					acceptBtn && acceptBtn.addEventListener('click', function(){ setConsent('yes'); });
					declineBtn && declineBtn.addEventListener('click', function(){ setConsent('no'); });
                    document.addEventListener('click', function(e){
						const t = e.target as HTMLElement;
						const el = t && (t.closest('[data-ev]') as HTMLElement | null);
						if(!el) return;
                        if(dnt || localStorage.getItem(consentKey) !== 'yes') return;
                        const type = el.getAttribute('data-ev') || 'event';
                        const label = el.getAttribute('data-label') || '';
                        const action = el.getAttribute('data-action') || '';
                        const position = el.getAttribute('data-position') || '';
                        const cta_level = el.getAttribute('data-cta-level') || 'soft';
                        const product = el.getAttribute('data-product') || 'na';
                        const persona = el.getAttribute('data-persona') || 'na';
                        const stage = el.getAttribute('data-stage') || 'na';
                        const url = new URL(location.href);
                        const utm_campaign = url.searchParams.get('utm_campaign') || '';
                        const utm_persona = url.searchParams.get('utm_persona') || '';
                        const utm_stage = url.searchParams.get('utm_stage') || '';
                        const record = {
                            timestamp: new Date().toISOString(),
                            event: type,
                            cta_level,
                            page: location.pathname,
                            product,
                            persona,
                            stage,
                            utm_campaign,
                            utm_persona,
                            utm_stage,
                            metadata: { label, action, position }
                        };
                        (window as any).dataLayer = (window as any).dataLayer || [];
                        (window as any).dataLayer.push(record);
                        try {
                            const key = 'marketing_events_jsonl';
                            const prev = localStorage.getItem(key) || '';
                            const line = JSON.stringify(record);
                            localStorage.setItem(key, prev ? (prev + '\n' + line) : line);
                        } catch {}
					});
				}catch{}
			})();
		</script>
        <script>
            (function(){
                try{
                    (window as any).metrics = (window as any).metrics || {};
                    (window as any).metrics.exportJSONL = function(){
                        try{
                            const key = 'marketing_events_jsonl';
                            const blob = new Blob([localStorage.getItem(key) || ''], { type: 'application/jsonl' });
                            const a = document.createElement('a');
                            a.href = URL.createObjectURL(blob);
                            a.download = 'events.jsonl';
                            document.body.appendChild(a); a.click(); document.body.removeChild(a);
                        }catch{}
                    };
                }catch{}
            })();
        </script>
		<script>
			(function(){
				try{
					// Mark current nav link for a11y
					const navLinks = document.querySelectorAll('nav .nav-links a[href^="/"]');
					navLinks.forEach((a)=>{
						try{
							const url = new URL((a as HTMLAnchorElement).href, location.origin);
							if(url.pathname === location.pathname){ (a as HTMLElement).setAttribute('aria-current','page'); }
						}catch{}
					});
                    const run = () => {
						const UTM = new URLSearchParams({ utm_source:'www', utm_medium:'cta', utm_campaign: (document.querySelector('[data-position]')?.getAttribute('data-position') || 'site') });
						function appendUtm(a){
							try{
								const href = a.getAttribute('href');
								if(!href || href.startsWith('mailto:') || href.startsWith('tel:')) return;
								const url = new URL(href, location.origin);
								if(url.origin !== location.origin) return; // keep internal only
								const q = new URLSearchParams(url.search);
								UTM.forEach((v,k)=>{ if(!q.has(k)) q.set(k,v); });
								url.search = q.toString();
								a.setAttribute('href', url.pathname + (url.search ? ('?' + url.search) : '') + (url.hash||''));
							}catch{}
						}
                        document.querySelectorAll('a[data-ev]')?.forEach(appendUtm);
                        // Mobile sheet nav
                        const openBtn=document.getElementById('nav-open') as HTMLButtonElement|null;
                        const closeBtn=document.getElementById('nav-close') as HTMLButtonElement|null;
                        const sheet=document.getElementById('mobile-nav') as HTMLDivElement|null;
                        function setOpen(v:boolean){ if(!(openBtn&&sheet)) return; openBtn.setAttribute('aria-expanded', String(v)); sheet.hidden=false; (sheet as HTMLElement).style.transform = v? 'translateY(0)': 'translateY(-100%)'; if(!v) setTimeout(()=>{ if(sheet) sheet.hidden=true; },180); }
                        function mq(){ return matchMedia('(max-width: 768px)').matches; }
                        if(openBtn && sheet){
                            openBtn.style.display = mq()? 'inline-flex':'none';
                            window.addEventListener('resize', ()=> openBtn.style.display = mq()? 'inline-flex':'none');
                            openBtn.addEventListener('click', ()=> setOpen(true));
                            closeBtn && closeBtn.addEventListener('click', ()=> setOpen(false));
                            document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') setOpen(false); });
                        }
                        // Mega menu interactions (Products & Solutions)
                        const consentKey='analytics_consent';
                        const dnt = (navigator as any).doNotTrack==='1' || (window as any).doNotTrack==='1';
                        function pl(ev:any){ if(dnt || localStorage.getItem(consentKey)!=='yes') return; (window as any).dataLayer=(window as any).dataLayer||[]; (window as any).dataLayer.push(ev);}
                        // Global menu manager ensures only one menu is open at a time
                        const allMenus = Array.from(document.querySelectorAll('[data-menu]')) as HTMLElement[];
                        const allTriggers = Array.from(document.querySelectorAll('[aria-haspopup="true"]')) as HTMLElement[];
                        function closeAll(){
                            allTriggers.forEach(b=> b.setAttribute('aria-expanded','false'));
                            allMenus.forEach(m=> m.hidden = true);
                            // unlock scroll on mobile when any menu closes
                            if(matchMedia('(max-width: 768px)').matches){ document.documentElement.style.overflow = ''; }
                        }
                        const navRoot = document.querySelector('nav');
                        navRoot && navRoot.addEventListener('mouseleave', closeAll);
                        document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeAll(); });

                        function wireMenu(btnId:string, menuId:string, name:string){
                            const trigger = document.getElementById(btnId) as HTMLButtonElement | null;
                            const menu = document.getElementById(menuId) as HTMLDivElement | null;
                            if(!(trigger && menu)) return;
                            let hoverTimer:any=null;
                            function open(){ closeAll(); trigger.setAttribute('aria-expanded','true'); menu.hidden=false; if(matchMedia('(max-width: 768px)').matches){ document.documentElement.style.overflow = 'hidden'; } pl({event:'menu_open', menu:name}); }
                            function close(){ trigger.setAttribute('aria-expanded','false'); menu.hidden=true; }
                            trigger.addEventListener('mouseenter', ()=> { clearTimeout(hoverTimer); hoverTimer=setTimeout(open,120); });
                            trigger.addEventListener('mouseleave', ()=> { clearTimeout(hoverTimer); });
                            trigger.addEventListener('click', (e)=>{ const ex = trigger.getAttribute('aria-expanded')==='true'; if(ex){ e.preventDefault(); close(); } else { // when closed, allow default navigation for hubs
                                const href = trigger.id==='btn-products' ? `${location.origin}${import.meta.env.BASE_URL}products/` : (trigger.id==='btn-solutions'? `${location.origin}${import.meta.env.BASE_URL}solutions/` : '');
                                if(href){ if(!(e.metaKey||e.ctrlKey||e.shiftKey||e.altKey)) { e.preventDefault(); location.href = href; (window as any).dataLayer=(window as any).dataLayer||[]; pl({event:'menu_hub_click', menu:name, source:'label'}); } }
                                else { e.preventDefault(); open(); }
                            } });
                            // Keyboard open on focus/ArrowDown/Space
                            trigger.addEventListener('focus', ()=> setTimeout(open, 0));
                            trigger.addEventListener('keydown', (e)=>{ if(e.key==='ArrowDown' || e.key===' '){ e.preventDefault(); open(); (menu.querySelector('.mega-cta') as HTMLElement)?.focus?.(); } });
                            menu.addEventListener('mouseleave', close);
                            document.addEventListener('click', (e)=>{ const t=e.target as HTMLElement; if(!t.closest('.nav-group') && !t.closest('[data-menu]')) closeAll(); });
                            // track clicks on primary links inside cards
                            menu.querySelectorAll('.mega-card .link').forEach((a)=> a.addEventListener('click', ()=> pl({event:'menu_item_click', menu:name, item:(a as HTMLElement).closest('.mega-card')?.querySelector('.h3')?.textContent?.trim()||''})));
                        }
                        wireMenu('btn-products','menu-products','products');
                        wireMenu('btn-solutions','menu-solutions','solutions');
                        wireMenu('btn-resources','menu-resources','resources');
                        wireMenu('btn-company','menu-company','company');
                        // Hub CTA analytics
                        document.getElementById('cta-products-hub')?.addEventListener('click', ()=> pl({event:'menu_hub_click', menu:'products', source:'cta'}));
                        document.getElementById('cta-solutions-hub')?.addEventListener('click', ()=> pl({event:'menu_hub_click', menu:'solutions', source:'cta'}));
					};
                    if('requestIdleCallback' in window){ (window as any).requestIdleCallback(run); } else { setTimeout(run, 0); }
                    // Sticky mobile CTA after ~20% scroll
                    const bar = document.getElementById('sticky-cta');
                    function showSticky(){
                        if(!bar) return;
                        const isMobile = matchMedia('(max-width: 768px)').matches;
                        const threshold = Math.max(240, Math.round(document.documentElement.scrollHeight * 0.2));
                        if(isMobile && window.scrollY > threshold){ bar.hidden = false; bar.classList.add('is-visible'); }
                        else { bar.classList.remove('is-visible'); }
                    }
                    window.addEventListener('scroll', showSticky, { passive:true });
                    window.addEventListener('resize', showSticky);
                    showSticky();
				}catch{}
			})();
		</script>
	</body>
</html>
