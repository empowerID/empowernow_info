---
import Base from '../../layouts/Base.astro';
const title = 'Search â€” EmpowerNow';
const description = 'Find products, solutions, and resources.';
const canonical = '/search/';
---
<Base title={title} description={description} canonical={canonical}>
	<section class="container" style="padding:48px 0 24px">
		<h1>Search</h1>
		<input id="q" type="search" placeholder="Search..." style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.06);color:#fff" />
		<div id="results" style="margin-top:16px"></div>
	</section>
	<script is:inline>
		(function(){
			var base = (import.meta && import.meta.env && import.meta.env.BASE_URL) ? import.meta.env.BASE_URL : '/';
			function init(){
				try{
					var input = document.getElementById('q');
					var results = document.getElementById('results');
					if(!input || !results || !(window).pagefind) return;

					async function run(q){
						var term = (q||'').trim();
						if(!term){ results.innerHTML = ''; return; }
						var res = await (window).pagefind.search(term);
						var items = await Promise.all(res.results.slice(0,20).map(function(r){ return r.data(); }));
						results.innerHTML = items.map(function(it){ return '<a class=\'btn\' href=\''+(it.url)+'\'>'+(it.meta && it.meta.title || it.url)+'</a>'; }).join('');
					}

					input.addEventListener('input', function(){ run(input.value); });

					try{
						var u = new URL(location.href);
						var q = u.searchParams.get('q') || '';
						if(q){ input.value = q; run(q); }
					}catch{}
				}catch{}
			}
			var s = document.createElement('script');
			s.src = base + 'pagefind/pagefind.js';
			s.onload = init; document.head.appendChild(s);
		})();
	</script>
</Base>
