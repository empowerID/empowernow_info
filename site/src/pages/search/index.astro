---
import Base from '../../layouts/Base.astro';
const title = 'Search â€” EmpowerNow';
const description = 'Find products, solutions, and resources.';
const canonical = '/search/';
---
<Base title={title} description={description} canonical={canonical}>
	<section class="container" style="padding:48px 0 24px">
		<h1>Search</h1>
		<input id="q" type="search" placeholder="Search..." style="width:100%;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.06);color:#fff" />
		<div id="results" style="margin-top:16px"></div>
	</section>
	<script>
		(async () => {
			try {
				// Load Pagefind JS bundle if available
				const mod = await import('https://cdn.jsdelivr.net/npm/pagefind@1/dist/pagefind.js');
				const pagefind = await (mod as any).default();
				const input = document.getElementById('q') as HTMLInputElement;
				const results = document.getElementById('results')!;
				input.addEventListener('input', async () => {
					const q = input.value.trim();
					if (!q) { results.innerHTML = ''; return; }
					const res = await pagefind.search(q);
					const items = await Promise.all(res.results.slice(0, 20).map((r: any) => r.data()));
					results.innerHTML = items.map((it: any) => `<a class="btn" href="${it.url}">${it.meta?.title || it.url}</a>`).join('');
				});
			} catch {}
		})();
	</script>
</Base>
